<div class="scale-selector" role="group" aria-label="...">
  <button type="button" [class.btn-selected]="!useLogYScale" (click)="this.useLogYScale = false; update()" class="btn btn-sm btn-selectable btn-sm btn-default">Linear Scale</button>
  <button type="button" [class.btn-selected]="useLogYScale" (click)="this.useLogYScale = true; update()" class="btn btn-sm btn-selectable btn-default">Log Scale</button>
  <div class="metric-selector">
    <div class="metric-selector-text">{{unitText}}</div>
    <div class="text-center padding-top metric-selector-div">
      <div class="dropdown" dropdown>
        <button class="btn btn-ga btn-dropdown selector-button" dropdownToggle>
          <div class="selector-button-text">{{selectedUnitName}}</div>
          <div><span class="caret"></span></div>
        </button>
        <ul id="dropdown" class="dropdown-menu" *dropdownMenu>
          <li *ngFor="let selectableUnit of selectableUnits" [class.active]="selectedUnitName === selectableUnit.name">
            <a (click)="selectedUnitName = selectableUnit.name; update()">{{selectableUnit.name}}</a>
          </li>
          <span id="end-of-dropdown"></span>
        </ul>
      </div>
    </div>
  </div>
</div>

<ngx-charts-chart [ngClass]="{ 'chart-hide-legend-text': !legendTitle }"
  [view]="[width + legendSpacing, height]"
  [showLegend]="showLegend"
  [legendOptions]="legendOptions"
  [activeEntries]="activeEntries"
  [animations]="animations"
  (legendLabelActivate)="onDataItemHoverEnter($event, undefined, true)"
  (legendLabelDeactivate)="onDataItemHoverLeave($event, undefined, true)"
  (legendLabelClick)="onClick($event)"
  xmlns:svg="">
  <svg:g [attr.transform]="transform" class="bar-chart chart">
    <svg:g class="chart-x-axis"
      ngx-charts-x-axis
      [xScale]="groupScale"
      [dims]="dims"
      [showLabel]="showXAxisLabel"
      [labelText]="xAxisLabel"
      [trimTicks]="trimXAxisTicks"
      [rotateTicks]="autoRotateXAxisTicks"
      [maxTickLength]="maxXAxisTickLength"
      [tickFormatting]="xAxisTickFormatting"
      [ticks]="xAxisTicks"
      [xAxisOffset]="dataLabelMaxHeight.negative"
      (dimensionsChanged)="updateXAxisHeight($event)"
    ></svg:g>
    <svg:g class="chart-y-axis"
      ngx-charts-y-axis
      [yScale]="valueScale"
      [dims]="dims"
      [showGridLines]="showGridLines"
      [showLabel]="showYAxisLabel"
      [labelText]="yAxisLabelResolved"
      [trimTicks]="false"
      [maxTickLength]="16"
      [tickFormatting]="yAxisTickFormattingInner"
      [ticks]="yAxisTicks"
      (dimensionsChanged)="updateYAxisWidth($event)"
    ></svg:g>
    <svg:g>
      <svg:g class="grouped-chart-vertical-bars"
        ngx-charts-series-vertical
        *ngFor="let group of dataInner; let index = index; trackBy: trackBy"
        [@animationState]="'active'"
        [attr.transform]="groupTransform(group)"
        [activeEntries]="activeEntries"
        [xScale]="innerScale"
        [yScale]="valueScale"
        [colors]="colors"
        [series]="group.series"
        [dims]="dims"
        [gradient]="enableGradientEffectOnBars"
        [tooltipDisabled]="tooltipDisabled"
        [tooltipTemplate]="tooltipTemplate"
        [showDataLabel]="showDataLabel"
        [dataLabelFormatting]="dataLabelFormatting"
        [seriesName]="group.name.toString()"
        [roundEdges]="roundEdges"
        [animations]="animations"
        [noBarWhenZero]="false"
        (select)="onClick($event, group)"
        (activate)="onDataItemHoverEnter($event, group)"
        (deactivate)="onDataItemHoverLeave($event, group)"
        (dataLabelHeightChanged)="onDataLabelMaxHeightChanged($event, index)"
      />
    </svg:g>
  </svg:g>
</ngx-charts-chart>
